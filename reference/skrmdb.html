<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>skrmdb package — DragBehr • skrmdb</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="skrmdb package — DragBehr"><meta name="description" content="The skrmdb package provides functionality to compute the median effective
dose (ED50) using the Dragstedt-Behrens, Reed-Muench, and Spearman-Kärber
estimators."><meta property="og:description" content="The skrmdb package provides functionality to compute the median effective
dose (ED50) using the Dragstedt-Behrens, Reed-Muench, and Spearman-Kärber
estimators."><meta property="og:image" content="https://abs-dev.github.io/skrmdb/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">skrmdb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/using_skrmdb.html">Using skrmdb</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ABS-dev/skrmdb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>skrmdb package</h1>
      <small class="dont-index">Source: <a href="https://github.com/ABS-dev/skrmdb/blob/HEAD/R/dragbehr.r" class="external-link"><code>R/dragbehr.r</code></a>, <a href="https://github.com/ABS-dev/skrmdb/blob/HEAD/R/reedmuench.r" class="external-link"><code>R/reedmuench.r</code></a>, <a href="https://github.com/ABS-dev/skrmdb/blob/HEAD/R/skrmdb.r" class="external-link"><code>R/skrmdb.r</code></a>, and 1 more</small>
      <div class="d-none name"><code>skrmdb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The skrmdb package provides functionality to compute the median effective
dose (ED50) using the Dragstedt-Behrens, Reed-Muench, and Spearman-Kärber
estimators.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DragBehr</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">y</span>, <span class="va">n</span>, <span class="va">x</span>, autosort <span class="op">=</span> <span class="cn">TRUE</span>, warn.me <span class="op">=</span> <span class="cn">TRUE</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ReedMuench</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  autosort <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warn.me <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SpearKarb</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  autosort <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warn.me <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula of the form <code>y + n ~ x</code> or <code>cbind(y, n) ~ x</code></p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>an integer vector corresponding to the number responding at each log
dilution or dose.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>an integer vector corresponding to the group size at each log
dilution or dose.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector corresponding to the log dilution or dose for each group.</p></dd>


<dt id="arg-autosort">autosort<a class="anchor" aria-label="anchor" href="#arg-autosort"></a></dt>
<dd><p>Default <code>TRUE</code>.  If <code>TRUE</code> will sort the data according to
either <code>sort(x)</code> or <code>sort(-x)</code> so that <code>y / n</code> appears to be increasing
with the index.  This is how the three methods assume the data to be
ordered.</p></dd>


<dt id="arg-warn-me">warn.me<a class="anchor" aria-label="anchor" href="#arg-warn-me"></a></dt>
<dd><p>if TRUE, warnings and messages related to the processing of
the data will be displayed.</p></dd>


<dt id="arg-show">show<a class="anchor" aria-label="anchor" href="#arg-show"></a></dt>
<dd><p>if TRUE, will print the intermediary statistics used to calculate
ED50.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <a href="skrmdb-class.html">skrmdb</a></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Dragstedt-Behrens and Reed-Muench methods estimate the median effective
dose by interpolating between the two doses that bracket the dose producing
median response. They accumulate sums in both directions by assuming that
those that responded at a lower dose would respond at a higher dose, and
those that did not respond at a higher dose would not respond at a lower
dose. The Dragstedt-Behrens method estimates ED50 by interpolating on the
line that connects the hypothetical fractions of the bracketing doses for
ED50, while the Reed-Muench method estimates ED50 as the intersection of the
lines connecting the two sets of cumulative sums between bracketing doses.</p>
<p>The Spearman-Karber method gives a non-parametric estimate of the mean of an
tolerance distribution from its empirical distribution (EDF). The empirical
PMF is derived from the EDF by differencing and the estimator is \(\sum{ x
f(x)}\). If the EDF does not cover the entire support of <code>x</code>,
<code>SpearKarb()</code> extends it by assuming the next lower dilution would
produce zero response and the next higher dilution would produce complete
response.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These methods assume that the <code>y</code> is monotonic in <code>x</code>,
however ED50 will still be computed if this is not the case. These methods
also assume that data brackets ED50.  If the data does not bracket ED50, a
result could still be returned, but the accuracy of this value in
estimating ED50 is suspect.</p>
<p>Many microbiology texts mistakenly present the Dragstedt-Behrens method
as the Reed-Muench method.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Behrens, B. (1929) Zur Auswertung der Digitalisblätter im
Froschversuch. <em>Arkiv für Experimentelle Pathologie und Pharmakologie.</em>
<strong>140: 237-256</strong>.</p>
<p>Dragstedt, C. A., Lang, V. F. (1928). Respiratory Stimulants in Acute
Cocaine Poisoning in Rabbits. <em>J. of Pharmacology and Experimental
Therapeutics.</em> <strong>32: 215–222</strong>.</p>
<p>Kärber, G. (1931). Beitrag zur kollektiven Behandlung Parmakogischer
Reihenversuche. <em>Archiv für Experimentelle Pathologie und Pharmakologie.</em>
<strong>162: 480–483</strong>.</p>
<p>Miller, Rupert G. (1973). Nonparametric Estimators of the Mean Tolerance in
Bioassay. <em>Biometrika.</em> <strong>60: 535 - 542</strong>.</p>
<p>Reed LJ, Muench H (1938). A Simple Method of Estimating Fifty Percent
Endpoints. <em>American Journal of Hygiene.</em> <strong>27: 493–497</strong>.</p>
<p>Spearman, C. (1908). The Method of "Right and Wrong Cases" ("Constant
Stimuli") without Gauss's Formulae. <em>Brit. J. of Psychology.</em> <strong>2:
227–242</strong>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/ABS-dev/skrmdb/" class="external-link">https://github.com/ABS-dev/skrmdb/</a></p></li>
<li><p>Report bugs at <a href="https://github.com/ABS-dev/skrmdb/issues/" class="external-link">https://github.com/ABS-dev/skrmdb/issues/</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: CVB Statistics <a href="mailto:CVB.Data.Help@usda.gov">CVB.Data.Help@usda.gov</a> [former owner]</p>
<p>Authors:</p><ul><li><p>David Siev (until 2019)</p></li>
<li><p>Marie Vendettuoli (until 2019)</p></li>
<li><p>Thomas Kent (starting 2020)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># All examples are with `SpearKarb`, however, the usage for</span></span></span>
<span class="r-in"><span><span class="co"># `DragBehr` and `ReedMuench` is identical.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Monotonically increasing data</span></span></span>
<span class="r-in"><span><span class="co"># The three calls are equivalent.</span></span></span>
<span class="r-in"><span><span class="va">dead</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dil</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">dead</span>, n <span class="op">=</span> <span class="va">total</span>, x <span class="op">=</span> <span class="va">dil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span><span class="va">dead</span> <span class="op">+</span> <span class="va">total</span> <span class="op">~</span> <span class="va">dil</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   2.9 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is increasing with dilution.</span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="va">n</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   2.9 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is increasing with dilution.</span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span>y <span class="op">=</span> <span class="va">dead</span>, n <span class="op">=</span> <span class="va">total</span>, x <span class="op">=</span> <span class="va">dil</span><span class="op">)</span>  <span class="co"># depreciated</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>skrmdb :: Calling this function with the parameters y, n, x is depreciated.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   2.9 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is increasing with dilution.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Decreasing data</span></span></span>
<span class="r-in"><span><span class="co"># The function will reverse the order of the data</span></span></span>
<span class="r-in"><span><span class="co"># and two calls are equivalent.</span></span></span>
<span class="r-in"><span><span class="va">dead</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dil</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span></span></span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span><span class="va">dead</span> <span class="op">+</span> <span class="va">total</span> <span class="op">~</span> <span class="va">dil</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   4.1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is decreasing with dilution.</span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">dead</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">dil</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   4.1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is decreasing with dilution.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Unordered data</span></span></span>
<span class="r-in"><span><span class="co"># Observe that the data is not monotonic after being sorted by dil.</span></span></span>
<span class="r-in"><span><span class="va">dead</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">SpearKarb</span><span class="op">(</span><span class="va">dead</span> <span class="op">+</span> <span class="va">total</span> <span class="op">~</span> <span class="va">dil</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> skrmdb :: y is not monotonic. ED50 may be unreliable.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ED50 by the Spearman-Karber method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ed:   3.1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Count trend is decreasing with dilution.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> y is not monotonic. ED50 may be unreliable.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by CVB Statistics, David Siev, Marie Vendettuoli, Thomas Kent.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

